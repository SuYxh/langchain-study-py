# Makefile ä½¿ç”¨æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç»é¡¹ç›®ä¸­ Makefile çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œå¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹é¡¹ç›®çš„å¼€å‘å’Œç®¡ç†ã€‚

## ğŸ“‹ ç›®å½•

- [æ¦‚è¿°](#æ¦‚è¿°)
- [å¯ç”¨å‘½ä»¤](#å¯ç”¨å‘½ä»¤)
- [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)
- [å‘½ä»¤è¯¦è§£](#å‘½ä»¤è¯¦è§£)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

## ğŸ¯ æ¦‚è¿°

æˆ‘ä»¬çš„ Makefile æä¾›äº†ç±»ä¼¼ npm scripts çš„å¿«é€Ÿå‘½ä»¤åŠŸèƒ½ï¼Œè®©ä½ å¯ä»¥é€šè¿‡ç®€å•çš„ `make` å‘½ä»¤æ¥æ‰§è¡Œå¸¸è§çš„å¼€å‘ä»»åŠ¡ã€‚è¿™äº›å‘½ä»¤åŸºäº `uv` åŒ…ç®¡ç†å™¨ï¼Œæä¾›äº†é«˜æ•ˆçš„ Python é¡¹ç›®ç®¡ç†ä½“éªŒã€‚

## ğŸš€ å¯ç”¨å‘½ä»¤

### æ ¸å¿ƒå‘½ä»¤

| å‘½ä»¤ | åŠŸèƒ½ | ç­‰ä»·çš„ uv å‘½ä»¤ |
|------|------|----------------|
| `make help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | - |
| `make main` | è¿è¡Œä¸»ç¨‹åº | `uv run src/main.py` |
| `make openrouter` | è¿è¡Œ OpenRouter æµ‹è¯• | `uv run src/openrouter.py` |
| `make install` | å®‰è£…é¡¹ç›®ä¾èµ– | `uv sync` |
| `make clean` | æ¸…ç† uv ç¼“å­˜ | `uv cache clean` |

### ä¼ªç›®æ ‡å£°æ˜

```makefile
.PHONY: dev openrouter main test-openrouter help
```

æ‰€æœ‰å‘½ä»¤éƒ½è¢«å£°æ˜ä¸ºä¼ªç›®æ ‡ï¼ˆPhony Targetsï¼‰ï¼Œç¡®ä¿å³ä½¿å­˜åœ¨åŒåæ–‡ä»¶ä¹Ÿèƒ½æ­£å¸¸æ‰§è¡Œã€‚

## ğŸ’» ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå¼€å§‹

```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
make help

# æˆ–è€…ç›´æ¥è¿è¡Œ makeï¼ˆé»˜è®¤æ˜¾ç¤ºå¸®åŠ©ï¼‰
make
```

### è¿è¡Œç¨‹åº

```bash
# è¿è¡Œä¸»ç¨‹åº
make main

# è¿è¡Œ OpenRouter æµ‹è¯•
make openrouter
```

### é¡¹ç›®ç®¡ç†

```bash
# å®‰è£…/æ›´æ–°ä¾èµ–
make install

# æ¸…ç†ç¼“å­˜ï¼ˆè§£å†³ä¾èµ–é—®é¢˜æ—¶ä½¿ç”¨ï¼‰
make clean
```

## ğŸ” å‘½ä»¤è¯¦è§£

### `make help`
**åŠŸèƒ½**: æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯

**è¾“å‡ºç¤ºä¾‹**:
```
å¯ç”¨çš„å‘½ä»¤:
  make main         - è¿è¡Œä¸»ç¨‹åº (src/main.py)
  make openrouter   - è¿è¡Œ OpenRouter æµ‹è¯• (src/openrouter.py)
  make test-openrouter - è¿è¡Œ OpenRouter æµ‹è¯• (src/openrouter.py)

æˆ–è€…ç›´æ¥ä½¿ç”¨ uv run:
  uv run src/main.py
  uv run src/openrouter.py
```

### `make main`
**åŠŸèƒ½**: è¿è¡Œé¡¹ç›®çš„ä¸»ç¨‹åº
- **æ–‡ä»¶**: `src/main.py`
- **ç”¨é€”**: é¡¹ç›®çš„ä¸»è¦å…¥å£ç‚¹
- **ç­‰ä»·å‘½ä»¤**: `uv run src/main.py`

### `make openrouter`
**åŠŸèƒ½**: è¿è¡Œ OpenRouter API æµ‹è¯•
- **æ–‡ä»¶**: `src/openrouter.py`
- **ç”¨é€”**: æµ‹è¯• OpenRouter API è¿æ¥å’ŒåŠŸèƒ½
- **ç­‰ä»·å‘½ä»¤**: `uv run src/openrouter.py`
- **æ³¨æ„**: éœ€è¦é…ç½® `.env` æ–‡ä»¶ä¸­çš„ API å¯†é’¥

### `make install`
**åŠŸèƒ½**: å®‰è£…å’ŒåŒæ­¥é¡¹ç›®ä¾èµ–
- **ç­‰ä»·å‘½ä»¤**: `uv sync`
- **ç”¨é€”**: 
  - é¦–æ¬¡è®¾ç½®é¡¹ç›®ç¯å¢ƒ
  - æ›´æ–°ä¾èµ–åˆ°æœ€æ–°ç‰ˆæœ¬
  - åŒæ­¥ `pyproject.toml` å’Œ `uv.lock`

### `make clean`
**åŠŸèƒ½**: æ¸…ç† uv ç¼“å­˜
- **ç­‰ä»·å‘½ä»¤**: `uv cache clean`
- **ç”¨é€”**:
  - è§£å†³ä¾èµ–å†²çªé—®é¢˜
  - é‡Šæ”¾ç£ç›˜ç©ºé—´
  - å¼ºåˆ¶é‡æ–°ä¸‹è½½åŒ…

## ğŸ› ï¸ æœ€ä½³å®è·µ

### 1. å¼€å‘å·¥ä½œæµ

```bash
# 1. é¦–æ¬¡è®¾ç½®é¡¹ç›®
make install

# 2. æ—¥å¸¸å¼€å‘
make main          # æµ‹è¯•ä¸»ç¨‹åº
make openrouter    # æµ‹è¯• API åŠŸèƒ½

# 3. é‡åˆ°é—®é¢˜æ—¶
make clean         # æ¸…ç†ç¼“å­˜
make install       # é‡æ–°å®‰è£…ä¾èµ–
```

### 2. å‘½ä»¤é€‰æ‹©å»ºè®®

- **å¿«é€Ÿæ‰§è¡Œ**: ä½¿ç”¨ `make` å‘½ä»¤ï¼ˆæ›´ç®€æ´ï¼‰
- **è°ƒè¯•éœ€è¦**: ä½¿ç”¨ `uv run` å‘½ä»¤ï¼ˆæ›´ç›´æ¥ï¼‰
- **è„šæœ¬ä¸­ä½¿ç”¨**: æ¨è `uv run`ï¼ˆæ›´æ˜ç¡®ï¼‰

### 3. ç¯å¢ƒé…ç½®

ç¡®ä¿ä½ çš„ç¯å¢ƒä¸­å·²å®‰è£…ï¼š
- `make` å·¥å…·ï¼ˆmacOS è‡ªå¸¦ï¼‰
- `uv` åŒ…ç®¡ç†å™¨
- æ­£ç¡®çš„ Python ç‰ˆæœ¬

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. `make: command not found`
**è§£å†³æ–¹æ¡ˆ**: å®‰è£… make å·¥å…·
```bash
# macOS (é€šå¸¸å·²é¢„è£…)
xcode-select --install

# æˆ–ä½¿ç”¨ Homebrew
brew install make
```

#### 2. `uv: command not found`
**è§£å†³æ–¹æ¡ˆ**: å®‰è£… uv åŒ…ç®¡ç†å™¨
```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

#### 3. ä¾èµ–å®‰è£…å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**: æ¸…ç†ç¼“å­˜åé‡æ–°å®‰è£…
```bash
make clean
make install
```

#### 4. API å¯†é’¥é”™è¯¯
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥ `.env` æ–‡ä»¶é…ç½®
```bash
# ç¡®ä¿ .env æ–‡ä»¶åŒ…å«æ­£ç¡®çš„ API å¯†é’¥
OPENROUTER_API_KEY=your_api_key_here
```

### è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹è¯¦ç»†è¾“å‡º**: ç›´æ¥ä½¿ç”¨ `uv run` å‘½ä»¤
2. **æ£€æŸ¥æ–‡ä»¶è·¯å¾„**: ç¡®ä¿ `src/` ç›®å½•ä¸‹çš„æ–‡ä»¶å­˜åœ¨
3. **éªŒè¯ç¯å¢ƒ**: è¿è¡Œ `uv --version` æ£€æŸ¥ uv æ˜¯å¦æ­£å¸¸å·¥ä½œ

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå‘½ä»¤æŒ‡å—](./quick-commands.md) - æ›´è¯¦ç»†çš„å‘½ä»¤ä½¿ç”¨è¯´æ˜
- [Make å’Œ Python æ¦‚å¿µ](./make-and-python-concepts.md) - æ·±å…¥ç†è§£ Make å’Œ Python æœºåˆ¶
- [uv ä½¿ç”¨æŒ‡å—](./uv-use.md) - uv åŒ…ç®¡ç†å™¨è¯¦ç»†è¯´æ˜
- [npm vs uv å¯¹æ¯”](./npm-uv-comparison.md) - åŒ…ç®¡ç†å™¨å¯¹æ¯”

## ğŸ‰ æ€»ç»“

Makefile ä¸ºæˆ‘ä»¬æä¾›äº†ç®€æ´ç»Ÿä¸€çš„å‘½ä»¤æ¥å£ï¼Œè®©é¡¹ç›®ç®¡ç†å˜å¾—æ›´åŠ é«˜æ•ˆã€‚é€šè¿‡è¿™äº›é¢„å®šä¹‰çš„å‘½ä»¤ï¼Œä½ å¯ä»¥ï¼š

- âœ… å¿«é€Ÿè¿è¡Œå’Œæµ‹è¯•ä»£ç 
- âœ… ç»Ÿä¸€å›¢é˜Ÿçš„å¼€å‘å·¥ä½œæµ
- âœ… ç®€åŒ–å¤æ‚çš„å‘½ä»¤æ“ä½œ
- âœ… æé«˜å¼€å‘æ•ˆç‡

è®°ä½ï¼šå½“ä½ ä¸ç¡®å®šä½¿ç”¨å“ªä¸ªå‘½ä»¤æ—¶ï¼Œæ€»æ˜¯å¯ä»¥è¿è¡Œ `make help` æ¥æŸ¥çœ‹æ‰€æœ‰å¯ç”¨é€‰é¡¹ï¼